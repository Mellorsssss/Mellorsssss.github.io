

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/titleicon.jpg">
  <link rel="icon" type="image/png" href="/img/titleicon.jpg">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="握着生活的断桨，奋力前行">
  <meta name="author" content="Melos">
  <meta name="keywords" content="">
  <title>CS143 PA2 实验指北 - 断桨</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":">","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"onlypost":false},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.3.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>断桨</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/background.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="CS143 PA2 实验指北">
              
            </span>

            
              <div class="mt-3">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-author" aria-hidden="true"></i>
      Melos
    </span>
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-02-01 09:59" pubdate>
        2021年2月1日 上午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      1.6k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      22
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">CS143 PA2 实验指北</h1>
            
            <div class="markdown-body">
              <p>cs143 在线课程的第二次实验，目标为实现cool语言的lexer。整个实验的核心就是通过flex自动化生成lexer，所以我的主要时间都在熟悉flex语法以及使用正则表达式编写规则上。本次实验开始，官方提供了auto grading测试脚本：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mellorsssss/PictureBed/img/20210201100339.png" srcset="/img/loading.gif" alt="PA2分数"></p>
<h3 id="实验过程"><a href="#实验过程" class="headerlink" title="实验过程"></a>实验过程</h3><h4 id="flex熟悉与使用"><a href="#flex熟悉与使用" class="headerlink" title="flex熟悉与使用"></a>flex熟悉与使用</h4><blockquote>
<p><code>flex</code> is a tool for generating <em>scanners</em>. A scanner is a program which recognizes lexical patterns in text. The <code>flex</code> program reads the given input files, or its standard input if no file names are given, for a description of a scanner to generate. The description is in the form of pairs of regular expressions and C code, called <em>rules</em>. <code>flex</code> generates as output a C source file, ‘<code>lex.yy.c</code>’ by default, which defines a routine <code>yylex()</code>. This file can be compiled and linked with the flex runtime library to produce an executable. When the executable is run, it analyzes its input for occurrences of the regular expressions. Whenever it finds one, it executes the corresponding C code.</p>
</blockquote>
<p>flex通过用户编写的规则（包括正则表达式（pattern）以及对应的动作(action)），自动生成一个对应的lexer。</p>
<p>flex的一些基本规则在实验指南中都有提及，如果想要进一步深入了解flex，个人建议通过<a target="_blank" rel="noopener" href="https://garudaxc.github.io/BisonTest/#Introduction">官方文档</a>。</p>
<h4 id="cool的token-class"><a href="#cool的token-class" class="headerlink" title="cool的token class"></a>cool的token class</h4><p>cool语言主要有以下的几类token class:</p>
<ol>
<li>Integers</li>
<li>Identifiers</li>
<li>Special Notations</li>
<li>Strings</li>
<li>Comments</li>
<li>Keywords</li>
<li>White Spaces</li>
</ol>
<p>下面逐个介绍如何为其编写flex规则，对于每一个token class，我都从<strong>匹配、semantic value获取</strong>两个方面介绍。</p>
<h5 id="Integers"><a href="#Integers" class="headerlink" title="Integers"></a>Integers</h5><p>在lexical语境下，cool定义的Integers就是0-9数字组成的字符串，故而使用<code>[0-9]+</code>即可匹配。</p>
<p>在词法分析阶段，不需要对整数的大小做出判断；换而言之 ，此时我们只需要保存Integer对应的字符串：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">cool_yylval.symbol = inttable.add_string(yytext);<br><span class="hljs-keyword">return</span> INT_CONST;<br></code></pre></td></tr></table></figure>
<p>这里的cool_yylval是在cool_parse.h中定义的一个自定义数据类型，其保存了在之后阶段中会使用的一系列语义信息，例如symbol中保存了symbol相关的语义值（cool_yylval.symbol的类型就是一个Symbol）；boolean中保存了布尔相关的语义值等等。</p>
<p>此处的<code>return INT_CONST</code>会在run time嵌入到yylex()中（参见flex文档），其返回值含义是当前token class的编号（各个值的枚举参见cool_parse.h）。</p>
<h5 id="Identifiers"><a href="#Identifiers" class="headerlink" title="Identifiers"></a>Identifiers</h5><p>cool中的identifiers分为Type Identifiers（例如String, Int）以及Object Identifiers（例如count_down）。</p>
<blockquote>
<p><strong>Trap！</strong></p>
<p>由于后文介绍的Keywords是大小写不敏感的（除了true以及false），故而在编写规则时，应该将Identifiers放到Keywords之后。</p>
</blockquote>
<p>两者的匹配与semantic值的设置如出一辙：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c">TYPE_ID         [A-Z][A-Za-z0<span class="hljs-number">-9</span>_]*<br>OBJ_ID          [a-z][A-Za-z0<span class="hljs-number">-9</span>_]*<br><br>&#123;TYPE_ID&#125;  &#123;<br>              cool_yylval.symbol = idtable.add_string(yytext);<br>              <span class="hljs-keyword">return</span> TYPEID;<br>           &#125;<br><br>&#123;OBJ_ID&#125;   &#123;<br>              cool_yylval.symbol = idtable.add_string(yytext);<br>              <span class="hljs-keyword">return</span> OBJECTID;<br>            &#125;<br></code></pre></td></tr></table></figure>
<h5 id="Special-Notations"><a href="#Special-Notations" class="headerlink" title="Special Notations"></a>Special Notations</h5><p>Special Notations包括单元、多元运算符、各种基本符号等。对于多元运算符，cool_parse.h中定义了其token_class对应的值，对于单元符号，其自身的ASCII值就是token class对应的值。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs c"> <span class="hljs-comment">/* </span><br><span class="hljs-comment">  * The single character operators</span><br><span class="hljs-comment">  */</span><br><br>\- |<br>\+ | <br>\~ | <br>\* | <br>\/ | <br>\&lt; | <br>\= | <br>\: | <br>\; | <br>\@ | <br>\&#123; | <br>\&#125; | <br>\, | <br>\. | <br>\( | <br>\) <span class="hljs-keyword">return</span> yytext[<span class="hljs-number">0</span>];<br><br> <span class="hljs-comment">/*</span><br><span class="hljs-comment">  *  The multiple-character operators.</span><br><span class="hljs-comment">  */</span><br><br>&#123;DARROW&#125;		&#123; <span class="hljs-keyword">return</span> (DARROW); &#125;<br><br>&#123;ASSIGN&#125;    &#123;<span class="hljs-keyword">return</span> (ASSIGN);&#125;<br><br>&#123;LE&#125;        &#123; <span class="hljs-keyword">return</span> (LE);&#125;<br></code></pre></td></tr></table></figure>
<h5 id="Strings"><a href="#Strings" class="headerlink" title="Strings"></a>Strings</h5><p>字符串的处理包括匹配以及错误处理，较为复杂。</p>
<p>当遇到一个<code>&quot;</code>时，开始解析字符串，直至出现错误或遇到下一个<code>&quot;</code>完成字符串的封闭。</p>
<p>在解析过程中，需要注意一些特殊情况：</p>
<ol>
<li><p>转义字符。所有以<code>\</code>开头的字符都是转义字符，其解释为<code>\</code>之后的字符；</p>
<blockquote>
<p><strong>Trap!</strong></p>
<p>这里的“所有……”不包括以下字符：</p>
<p>\n ,\t,\b,\f以及\0</p>
</blockquote>
</li>
<li><p>escaped newline。在一个字符串中，不可以直接连接两行，需要在一行末尾添加<code>\</code>；</p>
</li>
<li><p>null字符。如果解析过程中遇到了<code>\0</code>字符，则认为出错；</p>
</li>
<li><p>字符串过长。cool中设定字符串至多1024（不包括<code>\0</code>）</p>
</li>
</ol>
<p>此处指出了字符串处理成过程中的几种错误处理：</p>
<ol>
<li>中途换行。该错误视为用户没有添加右引号，所以应该从下一行开始解析；</li>
<li>包含<code>\0</code>字符。该错误视作该字符串无效，故而应该从下一行（如果还存在错误1）或从右引号下一个字符开始解析；</li>
<li>包含eof。该错误同样视作该字符串无效，处理方式同2；</li>
<li>字符串过长。处理方式同2。</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs c"> <span class="hljs-comment">/*</span><br><span class="hljs-comment">  *  String constants (C syntax)</span><br><span class="hljs-comment">  *  Escape sequence \c is accepted for all characters c. Except for </span><br><span class="hljs-comment">  *  \n \t \b \f, the result is c.</span><br><span class="hljs-comment">  *</span><br><span class="hljs-comment">  */</span><br><br>\<span class="hljs-string">&quot; &#123;</span><br><span class="hljs-string">    BEGIN(string);</span><br><span class="hljs-string">    str_len = 0;</span><br><span class="hljs-string">    string_buf_ptr = string_buf;</span><br><span class="hljs-string">   &#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">&lt;string&gt;\&quot; &#123;</span><br><span class="hljs-string">            BEGIN(0);</span><br><span class="hljs-string">            *string_buf_ptr = &#x27;\0&#x27;;</span><br><span class="hljs-string">            cool_yylval.symbol = stringtable.add_string(string_buf);</span><br><span class="hljs-string">            return STR_CONST;</span><br><span class="hljs-string">            &#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">&lt;string&gt;\n &#123;</span><br><span class="hljs-string">            cool_yylval.error_msg = &quot;</span>Unterminated <span class="hljs-built_in">string</span> constant<span class="hljs-string">&quot;;</span><br><span class="hljs-string">            BEGIN(0); /* start from the new line */</span><br><span class="hljs-string">            return (ERROR);</span><br><span class="hljs-string">            &#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">&lt;string&gt;\0 &#123;</span><br><span class="hljs-string">            cool_yylval.error_msg = &quot;</span>String contains escaped null character.<span class="hljs-string">&quot;;</span><br><span class="hljs-string">            BEGIN(invalid_string); /* start from the end of the string */</span><br><span class="hljs-string">            return (ERROR);</span><br><span class="hljs-string">            &#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">&lt;string&gt;&lt;&lt;EOF&gt;&gt; &#123;</span><br><span class="hljs-string">            cool_yylval.error_msg = &quot;</span>EOF in <span class="hljs-built_in">string</span> constant<span class="hljs-string">&quot;;</span><br><span class="hljs-string">            BEGIN(invalid_string); /* start from the end of the string */</span><br><span class="hljs-string">            return (ERROR);</span><br><span class="hljs-string">            &#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">&lt;string&gt;\\n |</span><br><span class="hljs-string">&lt;string&gt;\\b |</span><br><span class="hljs-string">&lt;string&gt;\\t |</span><br><span class="hljs-string">&lt;string&gt;\\f &#123;</span><br><span class="hljs-string">              str_len ++;</span><br><span class="hljs-string">              CHECK_STRING_LENGTH()</span><br><span class="hljs-string">              *string_buf_ptr++ = get_sp_char(yytext[1]);</span><br><span class="hljs-string">             &#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">&lt;string&gt;\\(.|\n) &#123;</span><br><span class="hljs-string">              str_len ++;</span><br><span class="hljs-string">              CHECK_STRING_LENGTH()</span><br><span class="hljs-string"></span><br><span class="hljs-string">              *string_buf_ptr++ = yytext[1];</span><br><span class="hljs-string">              if (yytext[1]==&#x27;\n&#x27;)&#123;</span><br><span class="hljs-string">                ++curr_lineno;</span><br><span class="hljs-string">              &#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">              if (yytext[1]==&#x27;\0&#x27;)&#123;</span><br><span class="hljs-string">                cool_yylval.error_msg = &quot;</span>String contains escaped null character.<span class="hljs-string">&quot;;</span><br><span class="hljs-string">                BEGIN(invalid_string);</span><br><span class="hljs-string">                return (ERROR);</span><br><span class="hljs-string">              &#125;</span><br><span class="hljs-string">             &#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">&lt;string&gt;[^\\\n\0\&quot;]+ &#123;</span><br><span class="hljs-string">                      char *yyptr = yytext;</span><br><span class="hljs-string">                      while(*yyptr)&#123;</span><br><span class="hljs-string">                        str_len ++;</span><br><span class="hljs-string">                        CHECK_STRING_LENGTH()</span><br><span class="hljs-string"></span><br><span class="hljs-string">                        *string_buf_ptr++ = *yyptr++;</span><br><span class="hljs-string">                      &#125;</span><br><span class="hljs-string">                    &#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">&lt;invalid_string&gt;[^\n&quot;</span>]*(\n|\<span class="hljs-string">&quot;) BEGIN(0); /* jump to the end of the string */</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure>
<h5 id="Comments"><a href="#Comments" class="headerlink" title="Comments"></a>Comments</h5><p>注释分为两种，单行注释（以<code>--</code>开头）以及多行嵌套注释（以<code>(*</code>开头）。</p>
<p>前者较为简单，后者需要考虑嵌套的情况。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-string">&quot;--&quot;</span>[^\n]* <span class="hljs-comment">/* single line comment, don&#x27;t eat up the \n*/</span><br><br> <span class="hljs-comment">/*</span><br><span class="hljs-comment">  *  Nested comments</span><br><span class="hljs-comment">  */</span><br><br><br>&#123;LEFTCOMMENT&#125; &#123;<br>              BEGIN(comment);<br>              comment_num =<span class="hljs-number">1</span>;<br>              &#125;<br><br>&lt;comment&gt;&#123;LEFTCOMMENT&#125; &#123;comment_num++;&#125;<br><br>&lt;comment&gt;[^(*\n]+  <span class="hljs-comment">/* eat up all the characters which are not * or newline */</span><br><br>&lt;comment&gt;<span class="hljs-string">&quot;(&quot;</span>+[^*]* <span class="hljs-comment">/* eat up all the ( which are not nested (*/</span><br><br>&lt;comment&gt;<span class="hljs-string">&quot;*&quot;</span>+[^*)\n]* <span class="hljs-comment">/* eat up all the * which are not follwed by *) or new line*/</span><br><br>&lt;comment&gt;&lt;&lt;EOF&gt;&gt; &#123;<br>            cool_yylval.error_msg = <span class="hljs-string">&quot;EOF in comment&quot;</span>;<br>            BEGIN(<span class="hljs-number">0</span>);<br>            <span class="hljs-keyword">return</span> (ERROR);<br>            &#125;<br><br>&lt;comment&gt;\n ++curr_lineno;<br><br>&lt;comment&gt;&#123;RIGHTCOMMENT&#125; &#123;<br>                          comment_num--;<br>                          <span class="hljs-keyword">if</span> (comment_num ==<span class="hljs-number">0</span>)&#123;<br>                              BEGIN(<span class="hljs-number">0</span>);<br>                          &#125;<br>                        &#125;<br></code></pre></td></tr></table></figure>
<h5 id="Keywords"><a href="#Keywords" class="headerlink" title="Keywords"></a>Keywords</h5><p>注意大小写即可，此处按下不表。</p>
<h5 id="White-Spaces"><a href="#White-Spaces" class="headerlink" title="White Spaces"></a>White Spaces</h5><p>需要将换行符单独考虑，维护代码行数，此处按下不表。</p>
<h3 id="实验总结"><a href="#实验总结" class="headerlink" title="实验总结"></a>实验总结</h3><p>PA2并不困难，只是较为繁琐（例如String以及Comment中状态机的设计），实验整体耗时大约8小时。</p>
<p>学习到的知识点：</p>
<ol>
<li>lexer工作基本流程；</li>
<li>flex如何使用，一些较为进阶的小技巧。</li>
</ol>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/compilers/">compilers</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/01/29/tj-211129/">
                        <span class="hidden-mobile">【区间DP】Polygon</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>

<!-- SCRIPTS -->

  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      var inputArea = document.querySelector("#local-search-input");
      inputArea.onclick = function () {
        searchFunc(path, 'local-search-input', 'local-search-result');
        this.onclick = null
      }
    })()
  </script>





  

  
    <!-- MathJax -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        options: {
          renderActions: {
            findScript: [10, doc => {
              document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                const display = !!node.type.match(/; *mode=display/);
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                const text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = { node: text, delim: '', n: 0 };
                math.end = { node: text, delim: '', n: 0 };
                doc.math.push(math);
              });
            }, '', false],
            insertedScript: [200, () => {
              document.querySelectorAll('mjx-container').forEach(node => {
                let target = node.parentNode;
                if (target.nodeName.toLowerCase() === 'li') {
                  target.parentNode.classList.add('has-jax');
                }
              });
            }, '', false]
          }
        }
      };
    </script>

    <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-svg.js" ></script>

  











<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>



</body>
</html>
